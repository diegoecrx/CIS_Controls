# 4.3.3 Ensure sudo log file exists

## Compliance Requirement

**Command to Check:**
```bash
/bin/grep -rPsi "^\h*Defaults\h+([^#]+,\h*)?logfile\h*=\h*(\"|\')?\H+(\"|\')?(,\h*\H+\h*)*\h*(#.*)?$" /etc/sudoers* | /bin/awk '{print} END {if (NR != 0) print "pass" ; else print "fail"}'
```

**Expected Output:**
```
^pass$
```

## Solution

Edit the file /etc/sudoers or a file in /etc/sudoers.d/ with visudo or visudo -f  and add the following line:

Defaults logfile=""

Example

Defaults logfile="/var/log/sudo.log"

Note:

 - sudo will read each file in /etc/sudoers.d skipping file names that end in ~ or contain a character to avoid causing problems with package manager or editor temporary/backup files.
 - Files are parsed in sorted lexical order. That is, /etc/sudoers.d/01_first will be parsed before /etc/sudoers.d/10_second
 - Be aware that because the sorting is lexical, not numeric, /etc/sudoers.d/1_whoops would be loaded after /etc/sudoers.d/10_second
 - Using a consistent number of leading zeroes in the file names can be used to avoid such problems.

Impact:

WARNING: Editing the sudo configuration incorrectly can cause sudo to stop functioning. Always use visudo to modify sudo configuration files.

Creation of additional log files can cause disk space exhaustion if not correctly managed. You should configure logrotate to manage the sudo log in accordance with your local policy.
