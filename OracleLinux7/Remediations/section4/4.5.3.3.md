# 4.5.3.3 Ensure default user umask is configured

## Compliance Requirement

**Command to Check:**
```bash
multiple line script
```

**Expected Output:**
```
(?i)^[\s]*\**[\s]*pass:?[\s]*\**$
```

**Timeout:** 7200 seconds

## Solution

Run the following script and perform the instructions in the output:

#!/usr/bin/env bash

{
   l_output="" l_output2="" l_out=""
   file_umask_chk()
   {
      if grep -Psiq -- '^h*umaskh+(0?[0-7][2-7]7|u(=[rwx]{0,3}),g=([rx]{0,2}),o=)(h*#.*)?$' "$l_file"; then
         l_out="$l_out
 - umask is set correctly in \"$l_file\""
      elif grep -Psiq -- '^h*umaskh+(([0-7][0-7][01][0-7]b|[0-7][0-7][0-7][0-6]b)|([0-7][01][0-7]b|[0-7][0-7][0-6]b)|(u=[rwx]{1,3},)?(((g=[rx]?[rx]?w[rx]?[rx]?b)(,o=[rwx]{1,3})?)|((g=[wrx]{1,3},)?o=[wrx]{1,3}b)))' "$l_file"; then
         l_output2="$l_output2
 - \"$l_file\""
      fi
   }
   while IFS= read -r -d $'0' l_file; do
      file_umask_chk
   done  /etc/profile.d/50-systemwide_umask.sh
"
   fi
}

Note:

 - This method only applies to bash and shell. If other shells are supported on the system, it is recommended that their configuration files also are checked
 - If the pam_umask.so module is going to be used to set umask ensure that it's not being overridden by another setting. Refer to the PAM_UMASK(8) man page for more information
