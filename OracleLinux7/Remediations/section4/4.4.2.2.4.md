# 4.4.2.2.4 Ensure password complexity is configured

## Compliance Requirement

**Command to Check:**
```bash

```

**Expected Output:**
```

```

## Solution

Edit /etc/security/pwquality.conf and add or modify the following line to set:

minclass = 4

--AND/OR--

dcredit = -_N>
ucredit = 
ocredit = 
lcredit = 

Example:

# printf '
%s' "minclass = 4" >> /etc/security/pwquality.conf

--AND/OR--

# printf '%s
' "dcredit = -1" "ucredit = -1" "ocredit = -1" "lcredit = -1" >> /etc/security/pwquality.conf

Run the following script to remove setting minclass dcredit ucredit lcredit and ocredit on the pam_pwquality.so module in the PAM files

#!/usr/bin/env bash

{
   for l_pam_file in system-auth password-auth; do
     sed -ri 's/(^s*passwords+(requisite|required|sufficient)s+pam_pwquality.so.*)(s+minclasss*=s*S+)(.*$)/14/' /etc/pam.d/"$l_pam_file"
     sed -ri 's/(^s*passwords+(requisite|required|sufficient)s+pam_pwquality.so.*)(s+dcredits*=s*S+)(.*$)/14/' /etc/pam.d/"$l_pam_file"
     sed -ri 's/(^s*passwords+(requisite|required|sufficient)s+pam_pwquality.so.*)(s+ucredits*=s*S+)(.*$)/14/' /etc/pam.d/"$l_pam_file"
     sed -ri 's/(^s*passwords+(requisite|required|sufficient)s+pam_pwquality.so.*)(s+lcredits*=s*S+)(.*$)/14/' /etc/pam.d/"$l_pam_file"
     sed -ri 's/(^s*passwords+(requisite|required|sufficient)s+pam_pwquality.so.*)(s+ocredits*=s*S+)(.*$)/14/' /etc/pam.d/"$l_pam_file"
   done
}
