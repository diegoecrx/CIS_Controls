# 4.4.2.2.2 Ensure password number of changed characters is configured

## Compliance Requirement

**Command to Check:**
```bash

```

**Expected Output:**
```

```

## Solution

Edit or add the following line in /etc/security/pwquality.conf to a value of 2 or more and meets local site policy:

difok = 2

Example:

# sed -ri 's/^s*difoks*=/# &/' /etc/security/pwquality.conf
# printf '
%s' "difok = 2" >> /etc/security/pwquality.conf

Run the following script to remove setting difok on the pam_pwquality.so module in the PAM files:

#!/usr/bin/env bash

{
   for l_pam_file in system-auth password-auth; do
     sed -ri 's/(^s*passwords+(requisite|required|sufficient)s+pam_pwquality.so.*)(s+difoks*=s*S+)(.*$)/14/' /etc/pam.d/"$l_pam_file"
   done
}
