# 1.3.2 Ensure permissions on bootloader config are configured

## Compliance Requirement

**Command to Check:**
```bash
multiple line script
```

**Expected Output:**
```
(?i)^[\s]*\**[\s]*pass:?[\s]*\**$
```

**Timeout:** 7200 seconds

## Solution

Run the following to update the mode, ownership, and group ownership of the grub configuration files:

-IF- the system uses UEFI (Files located in /boot/efi/EFI/* )

Edit /etc/fstab and add the fmask=0077 uid=0 and gid=0 options:

Example:

 /boot/efi vfat defaults,umask=0027,fmask=0077,uid=0,gid=0 0 0

Note: This may require a re-boot to enable the change

-OR-

-IF- the system uses BIOS (Files located in /boot/grub2/* )

Run the following commands to set ownership and permissions on your grub configuration file(s):

# [ -f /boot/grub2/grub.cfg ] && chown root:root /boot/grub2/grub.cfg
# [ -f /boot/grub2/grub.cfg ] && chmod u-x,go-rwx /boot/grub2/grub.cfg

# [ -f /boot/grub2/grubenv ] && chown root:root /boot/grub2/grubenv
# [ -f /boot/grub2/grubenv ] && chmod u-x,go-rwx /boot/grub2/grubenv

# [ -f /boot/grub2/user.cfg ] && chown root:root /boot/grub2/user.cfg
# [ -f /boot/grub2/user.cfg ] && chmod u-x,go-rwx /boot/grub2/user.cfg
