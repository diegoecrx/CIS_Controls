# 6.1.11 Ensure world writable files and directories are secured

## Compliance Requirement

**Command to Check:**
```bash

```

**Expected Output:**
```

```

## Solution

- World Writable Files:
 - It is recommended that write access is removed from other with the command ( chmod o-w  ), but always consult relevant vendor documentation to avoid breaking any application dependencies on a given file.

 - World Writable Directories:
 - Set the sticky bit on all world writable directories with the command ( chmod a+t  )

Run the following script to:

 - Remove other write permission from any world writable files
 - Add the sticky bit to all world writable directories

#!/usr/bin/env bash

{
   l_smask='01000'
   a_path=(); a_arr=() # Initialize array
   a_path=(! -path "/run/user/*" -a ! -path "/proc/*" -a ! -path "*/containerd/*" -a ! -path "*/kubelet/pods/*" -a ! -path "/sys/kernel/security/apparmor/*" -a ! -path "/snap/*" -a ! -path "/sys/fs/cgroup/memory/*" -a ! -path "/sys/fs/selinux/*")
   while read -r l_bfs; do
      a_path+=( -a ! -path ""$l_bfs"/*")
   done /dev/null)
   while IFS="^" read -r l_fname l_mode; do # Test files in the array
      if [ -f "$l_fname" ]; then # Remove excess permissions from WW files
         echo -e " - File: \"$l_fname\" is mode: \"$l_mode\"
 - removing write permission on \"$l_fname\" from \"other\""
         chmod o-w "$l_fname"
      fi
      if [ -d "$l_fname" ]; then
         if [ ! $(( $l_mode & $l_smask )) -gt 0 ]; then # Add sticky bit
            echo -e " - Directory: \"$l_fname\" is mode: \"$l_mode\" and doesn't have the sticky bit set
 - Adding the sticky bit"
            chmod a+t "$l_fname"
         fi
      fi
   done < <(printf '%s
' "${a_arr[@]}")
   unset a_path; unset a_arr # Remove array
}
