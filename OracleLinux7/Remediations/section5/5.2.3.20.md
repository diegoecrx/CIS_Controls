# 5.2.3.20 Ensure the audit configuration is immutable

## Compliance Requirement

**Command to Check:**
```bash
/bin/grep -Ph -- '^\h*-e\h+2\b' /etc/audit/rules.d/*.rules | tail -1
```

**Expected Output:**
```
^[\s]*-e[\s]+2[\s]*$
```

## Solution

Edit or create the file /etc/audit/rules.d/99-finalize.rules and add the line -e 2 at the end of the file:

Example:

# printf '%s
' "-e 2" > /etc/audit/rules.d/99-finalize.rules

Load audit rules

Merge and load the rules into active configuration:

# augenrules --load

Check if reboot is required.

# if [[ $(auditctl -s | grep "enabled") =~ "2" ]]; then printf "Reboot required to load rules
"; fi
