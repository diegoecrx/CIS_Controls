# 5.2.4.2 Ensure audit log files are mode 0640 or less permissive

## Compliance Requirement

**Command to Check:**
```bash
[ -f /etc/audit/auditd.conf ] && /bin/find "$(dirname $(awk -F "=" '/^\s*log_file/ {print $2}' /etc/audit/auditd.conf | /bin/xargs))" -type f \( ! -perm 600 -a ! -perm 0400 -a ! -perm 0200 -a ! -perm 0000 -a ! -perm 0640 -a ! -perm 0440 -a ! -perm 0040 \) -exec /bin/stat -Lc "%n %#a" {} + | /bin/awk '{print} END { if(NR==0) print "pass"; else print "fail"}'
```

**Expected Output:**
```
^pass$
```

**Timeout:** 7200 seconds

## Solution

Run the following command to remove more permissive mode than 0640 from audit log files:

# [ -f /etc/audit/auditd.conf ] && find "$(dirname $(awk -F "=" '/^s*log_file/ {print $2}' /etc/audit/auditd.conf | xargs))" -type f ( ! -perm 600 -a ! -perm 0400 -a ! -perm 0200 -a ! -perm 0000 -a ! -perm 0640 -a ! -perm 0440 -a ! -perm 0040 ) -exec chmod u-x,g-wx,o-rwx {} +
